<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ws_operation">
    <sys_ws_operation action="INSERT_OR_UPDATE">
        <active>true</active>
        <consumes>application/json</consumes>
        <consumes_customized>false</consumes_customized>
        <default_operation_uri/>
        <enforce_acl>cf9d01d3e73003009d6247e603f6a990</enforce_acl>
        <http_method>POST</http_method>
        <name>postresource</name>
        <operation_script><![CDATA[(function process(/*RESTAPIRequest*/ request, /*RESTAPIResponse*/ response) {
// implement resource here
var reqData = request.body.data.CreateIncidentRequest;
/*var transactionID;
var action;
var incidentNumber;
var accountName;
var summary;
var incidentDescription;
var something;
if (reqData instanceof Array) {
 transactionID = reqData[0].TransactionID;
 action = reqData[0].Action;
 incidentNumber = reqData[0].Incident.IncidentNumber;
 accountName = reqData[0].Incident.AccountName;
 summary = reqData[0].Incident.Summary;
 incidentDescription = reqData[0].Incident.Description;
} // if
else { */
 var transactionID = reqData.TransactionID;
 var action = reqData.Action;
 var incidentNumber = reqData.Incident.IncidentNumber;
 var accountName = reqData.Incident.AccountName;
 var summary = reqData.Incident.Summary;
 var incidentDescription = reqData.Incident.Description;
 var customerEmail = reqData.Incident.Customer.Email;
/*} // else */
	
var myObj = new GlideRecord('x_58872_needit_needit');
myObj.addQuery('correlation_id', '=', incidentNumber);
myObj.query();
var ticketNumber;
var sysid;
while(myObj.next()){
	//Logic you want to execute. Use myObj.field_name to reference record fields
	ticketNumber = myObj.number;
	sysid = myObj.sys_id;
} // while
	
var act = action.toUpperCase();
switch (action.toUpperCase()) {
  case 'CREATE':
	something = 'It is a Create request.';
	break;

  case 'UPDATE':
	something = 'It is a Update request.';
	break;
		
  case 'REASSIGN':
	something = 'It is a Reassign request.';
	break;

  case 'RESOLVE':
	something = 'It is a Resolve request.';
	break;

  case 'CLOSE':
	something = 'It is a Close request.';
	break;

  case 'CANCEL':
	something = 'It is a Cancel request.';
	break;

	default:
	something = 'Invalid Action.';
} // switch
	
response.setContentType('application/json');
response.setStatus(200);
var body = {};
body.TransactionID = transactionID;
body.Action = act;
body.ActionValidity = something;
body.IncidentNumber = incidentNumber;
body.AccountName = accountName;
body.Summary = summary;
body.Description = incidentDescription;	
body.CustomerEmail = customerEmail;
body.Sys_IS = sysid;
body.TicketNumber = ticketNumber;
response.setBody(body);	
})(request, response);]]></operation_script>
        <operation_uri>/api/x_58872_needit/needit_api</operation_uri>
        <produces>application/json,application/xml,text/xml</produces>
        <produces_customized>false</produces_customized>
        <relative_path>/</relative_path>
        <request_example/>
        <requires_acl_authorization>true</requires_acl_authorization>
        <requires_authentication>true</requires_authentication>
        <requires_snc_internal_role>true</requires_snc_internal_role>
        <short_description/>
        <sys_class_name>sys_ws_operation</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-08-11 09:54:09</sys_created_on>
        <sys_id>be140e311bae1010b28f8515ec4bcbcf</sys_id>
        <sys_mod_count>35</sys_mod_count>
        <sys_name>postresource</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_ws_operation_be140e311bae1010b28f8515ec4bcbcf</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-08-12 12:12:42</sys_updated_on>
        <web_service_definition display_value="NeedIt API">7562cafd1b6e1010b28f8515ec4bcb2f</web_service_definition>
        <web_service_version/>
    </sys_ws_operation>
</record_update>
